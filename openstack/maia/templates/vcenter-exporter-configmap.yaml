{{- if .Values.vcenter_exporter.enabled }}
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: vcenter-exporter
  labels:
    system: openstack
    service: metrics
    component: configuration
data:
{{- range $config := .Values.maia_vcenter_config }}
  {{$config.name}}.yaml: |
    main:
      host: '{{$config.vcenter_ip}}'
      user: '{{$config.username}}'
      password: '{{$config.password}}'
      port: 443
      ignore_ssl: True
      interval: 60
      log: 'INFO'
      vm_metrics:
      - 'cpu.usage.average'
      - 'cpu.usagemhz.average'
      - 'cpu.ready.summation'
      - 'mem.usage.average'
      - 'mem.swapinRate.average'
      - 'mem.swapoutRate.average'
      - 'mem.vmmemctl.average'
      - 'mem.consumed.average'
      - 'mem.overhead.average'
      - 'disk.usage.average'
{{- end }}
{{- end }}

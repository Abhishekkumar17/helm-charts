apiVersion: "openstack.stable.sap.cc/v1"
kind: "OpenstackSeed"
metadata:
  name: lyra-seed
  labels:
    app: {{ template "fullname" . }}
    chart: "{{ .Chart.Name }}-{{ .Chart.Version }}"
    release: "{{ .Release.Name }}"
    heritage: "{{ .Release.Service }}"
    component: lyra
    type: seed
spec:
  requires:
  #- monsoon3/keystone-seed                 # uncomment once keystone is deployed via its own helm-charts chart
  - swift/swift-seed
  - monsoon3/domain-default-seed
  - monsoon3/domain-ccadmin-seed

services:
  - name: Lyra
    type: automation
    description: 'Lyra automation service'
    endpoints:
    - interface: public
      region: '{{.Values.openstack.global.region}}'
      url: '{{.Values.openstack.global.lyra_api_endpoint_protocol_public}}://{{include "lyra_api_endpoint_host_public" .}}:{{.Values.openstack.global.lyra_api_port_public}}'

domains:
  - name: Default
    users:
    - name: {{ default "automation" .Values.auth.userID | quote }}
      description: 'Automation Service'
      password: {{ .Values.auth.password | quote }}
      roles:
      - project: service
        role: service
      - project: master@ccadmin
        role: swiftoperator
